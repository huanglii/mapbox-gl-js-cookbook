import{_ as e,c as o,b as s,d as l,a as c,r as a,o as i}from"./app-COZMOXYE.js";const u={};function r(k,n){const p=a("common-code-view"),t=a("ClientOnly");return i(),o("div",null,[s(t,null,{default:l(()=>[s(p,{name:"track-typhoon","is-code-view":!1})]),_:1}),n[0]||(n[0]=c(`<div class="language-javascript line-numbers-mode" data-highlighter="prismjs" data-ext="js" data-title="js"><pre><code><span class="line"><span class="token keyword">import</span> <span class="token punctuation">{</span></span>
<span class="line">  point <span class="token keyword">as</span> pointHelper<span class="token punctuation">,</span></span>
<span class="line">  lineString <span class="token keyword">as</span> lineStringHelper<span class="token punctuation">,</span></span>
<span class="line">  polygon <span class="token keyword">as</span> polygonHelper<span class="token punctuation">,</span></span>
<span class="line">  featureCollection <span class="token keyword">as</span> featureCollectionHelper<span class="token punctuation">,</span></span>
<span class="line"><span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">&#39;@turf/helpers&#39;</span></span>
<span class="line"><span class="token keyword">import</span> lineArc <span class="token keyword">from</span> <span class="token string">&#39;@turf/line-arc&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">import</span> lekima <span class="token keyword">from</span> <span class="token string">&#39;./data/lekima.json&#39;</span></span>
<span class="line"></span>
<span class="line"><span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">addTyphoonLayer</span><span class="token punctuation">(</span><span class="token parameter">map</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> typhoonFeatureCollection <span class="token operator">=</span> <span class="token function">pointsToFeatureCollection</span><span class="token punctuation">(</span>lekima<span class="token punctuation">.</span>points<span class="token punctuation">)</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addSource</span><span class="token punctuation">(</span><span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;geojson&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">data</span><span class="token operator">:</span> typhoonFeatureCollection<span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 风圈</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;wind-circle-layer&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;fill&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;fill-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;rgba(74, 110, 140, 0.4)&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;fill-outline-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;rgba(74, 110, 140, 1)&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Polygon&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;wind-circle&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 台风路径线</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;track-line-layer&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;line-width&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;interpolate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;linear&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;zoom&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;line-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;#fb5614&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;LineString&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;track&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 台风预测路径线</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;forecast-line-layer&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;line&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;line-width&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;interpolate&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;linear&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;zoom&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;line-dasharray&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;line-color&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">&#39;match&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;tm&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;中国&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FF4050&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;中国香港&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FF66FF&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;中国台湾&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FFA040&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;日本&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#43FF4B&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;美国&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#40DDFF&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#ff0000&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;LineString&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;forecast&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 台风路径点</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;track-point-layer&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;circle&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">paint</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;circle-radius&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">&#39;interpolate&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;cubic-bezier&#39;</span><span class="token punctuation">,</span> <span class="token number">0.85</span><span class="token punctuation">,</span> <span class="token number">0.45</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0.65</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;zoom&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">5</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;to-number&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;power&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">0.4</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token number">10</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;*&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;to-number&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;power&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;circle-color&#39;</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="line">        <span class="token string">&#39;match&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">[</span><span class="token string">&#39;get&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;strong&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;热带低压&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#00FEDF&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;热带风暴&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FEF300&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;强热带风暴&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FE902C&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;台风&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FE0404&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;强台风&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#FE3AA3&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;超强台风&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#AE00D9&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token string">&#39;#ff0000&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;circle-opacity&#39;</span><span class="token operator">:</span> <span class="token number">0.8</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;circle-stroke-width&#39;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token string-property property">&#39;circle-stroke-color&#39;</span><span class="token operator">:</span> <span class="token string">&#39;rgba(110, 110, 110, .3)&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Point&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;in&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;track&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;forecast&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token comment">// 当前台风点</span></span>
<span class="line">  map<span class="token punctuation">.</span><span class="token function">addLayer</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">id</span><span class="token operator">:</span> <span class="token string">&#39;points&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;symbol&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">source</span><span class="token operator">:</span> <span class="token string">&#39;typhoon-source&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">layout</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token string-property property">&#39;icon-image&#39;</span><span class="token operator">:</span> <span class="token string">&#39;i-typhoon&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token literal-property property">filter</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">&#39;all&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;$type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;Point&#39;</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token string">&#39;==&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;type&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;current&#39;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * 台风点数据转换为 GeoJSON FeatureCollection</span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Array<span class="token punctuation">}</span></span> <span class="token parameter">typhoonPoints</span></span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">pointsToFeatureCollection</span><span class="token punctuation">(</span><span class="token parameter">typhoonPoints</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> typhoonFeatures <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token comment">// 路径点</span></span>
<span class="line">  <span class="token keyword">let</span> trackPoints <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> typhoonPoints<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> typhoonPoint <span class="token operator">=</span> typhoonPoints<span class="token punctuation">[</span>i<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token punctuation">[</span>typhoonPoint<span class="token punctuation">.</span>lng <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">,</span> typhoonPoint<span class="token punctuation">.</span>lat <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">    trackPoints<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span></span>
<span class="line">    <span class="token comment">// 属性</span></span>
<span class="line">    <span class="token keyword">let</span> prop <span class="token operator">=</span> <span class="token punctuation">{</span> <span class="token operator">...</span>typhoonPoint <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>prop<span class="token punctuation">[</span><span class="token string">&#39;forecast&#39;</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">delete</span> prop<span class="token punctuation">.</span>forecast</span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&lt;</span> len <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token function">pointHelper</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token operator">...</span>prop<span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;track&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="line">      typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span></span>
<span class="line">        <span class="token function">pointHelper</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">          <span class="token operator">...</span>prop<span class="token punctuation">,</span></span>
<span class="line">          <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;current&#39;</span><span class="token punctuation">,</span></span>
<span class="line">        <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token comment">// 路径线</span></span>
<span class="line">  typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span></span>
<span class="line">    <span class="token function">lineStringHelper</span><span class="token punctuation">(</span>trackPoints<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;track&#39;</span><span class="token punctuation">,</span></span>
<span class="line">    <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">let</span> currentTyphoonPoint <span class="token operator">=</span> typhoonPoints<span class="token punctuation">[</span>typhoonPoints<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token comment">// 风圈</span></span>
<span class="line">  typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token operator">...</span><span class="token function">generateWindCircleFeature</span><span class="token punctuation">(</span>currentTyphoonPoint<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="line"></span>
<span class="line">  <span class="token comment">// 取当前点的预测数据</span></span>
<span class="line">  <span class="token keyword">let</span> forecastAgencys <span class="token operator">=</span> currentTyphoonPoint<span class="token punctuation">.</span>forecast</span>
<span class="line">  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">let</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">,</span> len <span class="token operator">=</span> forecastAgencys<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i <span class="token operator">&lt;</span> len<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token keyword">const</span> forecastAgency <span class="token operator">=</span> forecastAgencys<span class="token punctuation">[</span>i<span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">let</span> <span class="token punctuation">{</span> forecastpoints<span class="token punctuation">,</span> tm <span class="token punctuation">}</span> <span class="token operator">=</span> forecastAgency</span>
<span class="line">    <span class="token comment">// 预测点</span></span>
<span class="line">    <span class="token keyword">let</span> forecastPoints <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="line">    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">const</span> forecastpoint <span class="token keyword">of</span> forecastpoints<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">      <span class="token keyword">let</span> point <span class="token operator">=</span> <span class="token punctuation">[</span>forecastpoint<span class="token punctuation">.</span>lng <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">,</span> forecastpoint<span class="token punctuation">.</span>lat <span class="token operator">-</span> <span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">      forecastPoints<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span>point<span class="token punctuation">)</span></span>
<span class="line">      <span class="token keyword">if</span> <span class="token punctuation">(</span>i <span class="token operator">&gt;=</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">        <span class="token comment">// 第一个点及当前台风点，不需要</span></span>
<span class="line">        typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span></span>
<span class="line">          <span class="token function">pointHelper</span><span class="token punctuation">(</span>point<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">            <span class="token operator">...</span>forecastpoint<span class="token punctuation">,</span></span>
<span class="line">            tm<span class="token punctuation">,</span></span>
<span class="line">            <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;forecast&#39;</span><span class="token punctuation">,</span></span>
<span class="line">          <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">        <span class="token punctuation">)</span></span>
<span class="line">      <span class="token punctuation">}</span></span>
<span class="line">    <span class="token punctuation">}</span></span>
<span class="line">    <span class="token comment">// 预测线</span></span>
<span class="line">    typhoonFeatures<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span></span>
<span class="line">      <span class="token function">lineStringHelper</span><span class="token punctuation">(</span>forecastPoints<span class="token punctuation">,</span> <span class="token punctuation">{</span></span>
<span class="line">        tm<span class="token punctuation">,</span></span>
<span class="line">        <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;forecast&#39;</span><span class="token punctuation">,</span></span>
<span class="line">      <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line">    <span class="token punctuation">)</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">featureCollectionHelper</span><span class="token punctuation">(</span>typhoonFeatures<span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * 生成台风点的风圈风圈（面）</span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Object<span class="token punctuation">}</span></span> <span class="token parameter">typhoonPoint</span></span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">generateWindCircleFeature</span><span class="token punctuation">(</span><span class="token parameter">typhoonPoint</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> center <span class="token operator">=</span> <span class="token punctuation">[</span>typhoonPoint<span class="token punctuation">.</span>lng<span class="token punctuation">,</span> typhoonPoint<span class="token punctuation">.</span>lat<span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">let</span> windCircle7 <span class="token operator">=</span> <span class="token function">radiiToPolygon</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> typhoonPoint<span class="token punctuation">.</span>radius7<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">let</span> windCircle10 <span class="token operator">=</span> <span class="token function">radiiToPolygon</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> typhoonPoint<span class="token punctuation">.</span>radius10<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">let</span> windCircle12 <span class="token operator">=</span> <span class="token function">radiiToPolygon</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> typhoonPoint<span class="token punctuation">.</span>radius12<span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">return</span> <span class="token punctuation">[</span>windCircle7<span class="token punctuation">,</span> windCircle10<span class="token punctuation">,</span> windCircle12<span class="token punctuation">]</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span>
<span class="line"><span class="token doc-comment comment">/**</span>
<span class="line"> * 四个方向的半径转为风圈面</span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>Array<span class="token punctuation">}</span></span> <span class="token parameter">center</span> 中心点</span>
<span class="line"> * <span class="token keyword">@param</span> <span class="token class-name"><span class="token punctuation">{</span>String<span class="token punctuation">}</span></span> <span class="token parameter">radii</span> 风圈半径 &#39;320|380|300|380&#39;</span>
<span class="line"> */</span></span>
<span class="line"><span class="token keyword">function</span> <span class="token function">radiiToPolygon</span><span class="token punctuation">(</span><span class="token parameter">center<span class="token punctuation">,</span> radii</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="line">  <span class="token keyword">let</span> radiiArr <span class="token operator">=</span> radii<span class="token punctuation">.</span><span class="token function">split</span><span class="token punctuation">(</span><span class="token string">&#39;|&#39;</span><span class="token punctuation">)</span></span>
<span class="line">  <span class="token keyword">let</span> rNE <span class="token operator">=</span> radiiArr<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">let</span> rSE <span class="token operator">=</span> radiiArr<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">let</span> rSW <span class="token operator">=</span> radiiArr<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span></span>
<span class="line">  <span class="token keyword">let</span> rNW <span class="token operator">=</span> radiiArr<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span></span>
<span class="line"></span>
<span class="line">  <span class="token keyword">let</span> lineArcOptions <span class="token operator">=</span> <span class="token punctuation">{</span></span>
<span class="line">    <span class="token literal-property property">steps</span><span class="token operator">:</span> <span class="token number">100</span><span class="token punctuation">,</span></span>
<span class="line">  <span class="token punctuation">}</span></span>
<span class="line">  <span class="token keyword">let</span> ne <span class="token operator">=</span> <span class="token function">lineArc</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> rNE<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> lineArcOptions<span class="token punctuation">)</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates</span>
<span class="line">  <span class="token keyword">let</span> se <span class="token operator">=</span> <span class="token function">lineArc</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> rSE<span class="token punctuation">,</span> <span class="token number">90</span><span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> lineArcOptions<span class="token punctuation">)</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates</span>
<span class="line">  <span class="token keyword">let</span> sw <span class="token operator">=</span> <span class="token function">lineArc</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> rSW<span class="token punctuation">,</span> <span class="token number">180</span><span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> lineArcOptions<span class="token punctuation">)</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates</span>
<span class="line">  <span class="token keyword">let</span> nw <span class="token operator">=</span> <span class="token function">lineArc</span><span class="token punctuation">(</span>center<span class="token punctuation">,</span> rNW<span class="token punctuation">,</span> <span class="token number">270</span><span class="token punctuation">,</span> <span class="token number">360</span><span class="token punctuation">,</span> lineArcOptions<span class="token punctuation">)</span><span class="token punctuation">.</span>geometry<span class="token punctuation">.</span>coordinates</span>
<span class="line">  <span class="token keyword">return</span> <span class="token function">polygonHelper</span><span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">...</span>ne<span class="token punctuation">,</span> <span class="token operator">...</span>se<span class="token punctuation">,</span> <span class="token operator">...</span>sw<span class="token punctuation">,</span> <span class="token operator">...</span>nw<span class="token punctuation">,</span> ne<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">type</span><span class="token operator">:</span> <span class="token string">&#39;wind-circle&#39;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="line"><span class="token punctuation">}</span></span>
<span class="line"></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1))])}const v=e(u,[["render",r],["__file","track-typhoon.html.vue"]]),m=JSON.parse('{"path":"/example/track-typhoon.html","title":"","lang":"zh-CN","frontmatter":{},"headers":[],"git":{"updatedTime":1631424814000,"contributors":[{"name":"黄俐","username":"黄俐","email":"li.huangli@qq.com","commits":1,"url":"https://github.com/黄俐"},{"name":"huangli","username":"huangli","email":"849151701@qq.com","commits":1,"url":"https://github.com/huangli"}]},"filePathRelative":"example/track-typhoon.md"}');export{v as comp,m as data};
