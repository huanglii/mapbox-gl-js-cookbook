import{_ as p,r as o,o as c,c as i,a as n,b as s,d as t,e}from"./app-WXFCxs9o.js";const l={},r=n("h1",{id:"雪碧图",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#雪碧图","aria-hidden":"true"},"#"),s(" 雪碧图")],-1),u={href:"https://docs.mapbox.com/mapbox-gl-js/style-spec/sprite/",target:"_blank",rel:"noopener noreferrer"},k=e(`<p>如果图层样式中有使用 <code>background-pattern</code>、<code>fill-pattern</code>、<code>line-pattern</code>、<code>fill-extrusion-pattern</code>、或 <code>icon-image</code> 属性，则必须设置该属性。例如：</p><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Style property</span>
<span class="token string-property property">&#39;sprite&#39;</span><span class="token operator">:</span> <span class="token string">&#39;https://naivemap.com/mapbox/sprite&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token comment">// Layout property of SymbolLayer</span>
<span class="token string-property property">&#39;icon-image&#39;</span><span class="token operator">:</span> <span class="token string">&#39;cat&#39;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="雪碧图文件" tabindex="-1"><a class="header-anchor" href="#雪碧图文件" aria-hidden="true">#</a> 雪碧图文件</h2><p>一个有效的雪碧图必须包含两种文件：索引和图片。在加载时，会自动生成完整的 URLs：</p>`,5),d={href:"https://api.mapbox.com/styles/v1/mapbox/light-v9/sprite.json?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA",target:"_blank",rel:"noopener noreferrer"},m={href:"https://api.mapbox.com/styles/v1/mapbox/light-v9/sprite.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA",target:"_blank",rel:"noopener noreferrer"},v={href:"https://api.mapbox.com/styles/v1/mapbox/light-v9/sprite@2x.json?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA",target:"_blank",rel:"noopener noreferrer"},g={href:"https://api.mapbox.com/styles/v1/mapbox/light-v9/sprite@2x.png?access_token=pk.eyJ1IjoibWFwYm94IiwiYSI6ImNpejY4M29iazA2Z2gycXA4N2pmbDZmangifQ.-g_vE53SD2WrJ6tFX7QHmA",target:"_blank",rel:"noopener noreferrer"},h=e('<h2 id="添加-创建雪碧图" tabindex="-1"><a class="header-anchor" href="#添加-创建雪碧图" aria-hidden="true">#</a> 添加/创建雪碧图</h2><p>通常我们会使用一些自己的图标，下面介绍几种使用自定义图标的方法：</p><h3 id="mapbox-gl-js-api" tabindex="-1"><a class="header-anchor" href="#mapbox-gl-js-api" aria-hidden="true">#</a> Mapbox GL JS API</h3><h4 id="addimage" tabindex="-1"><a class="header-anchor" href="#addimage" aria-hidden="true">#</a> addImage</h4>',4),b={href:"https://docs.mapbox.com/mapbox-gl-js/api/#map#addimage",target:"_blank",rel:"noopener noreferrer"},_=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>map<span class="token punctuation">.</span><span class="token function">loadImage</span><span class="token punctuation">(</span><span class="token string">&#39;./images/cat.png&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> image</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">throw</span> error
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span>map<span class="token punctuation">.</span><span class="token function">hasImage</span><span class="token punctuation">(</span><span class="token string">&#39;cat&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> map<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span><span class="token string">&#39;cat&#39;</span><span class="token punctuation">,</span> image<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),f={href:"https://docs.mapbox.com/mapbox-gl-js/api/#map.event:styleimagemissing",target:"_blank",rel:"noopener noreferrer"},y=n("code",null,"id",-1),x=e(`<div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code>map<span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&#39;styleimagemissing&#39;</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> id <span class="token operator">=</span> e<span class="token punctuation">.</span>id <span class="token comment">// 丢失图片 id</span>
  map<span class="token punctuation">.</span><span class="token function">loadImage</span><span class="token punctuation">(</span>url<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token parameter">error<span class="token punctuation">,</span> image</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>error<span class="token punctuation">)</span> <span class="token keyword">throw</span> error
    map<span class="token punctuation">.</span><span class="token function">addImage</span><span class="token punctuation">(</span>id<span class="token punctuation">,</span> image<span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,1),j={href:"https://docs.mapbox.com/mapbox-gl-js/example/add-image-missing-generated/",target:"_blank",rel:"noopener noreferrer"},w=n("h3",{id:"mapbox-studio",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#mapbox-studio","aria-hidden":"true"},"#"),s(" Mapbox Studio")],-1),I={href:"https://studio.mapbox.com/",target:"_blank",rel:"noopener noreferrer"},S=n("code",null,"sprite.png",-1),z=n("code",null,"sprite@2x.png",-1),N=n("code",null,"sprite.json",-1),L=n("code",null,"sprite@2x.json",-1),A={class:"custom-container tip"},F=n("p",{class:"custom-container-title"},"提示",-1),D=n("code",null,"svg",-1),Y={href:"https://www.iconfont.cn/",target:"_blank",rel:"noopener noreferrer"},J={href:"https://labs.mapbox.com/maki-icons/",target:"_blank",rel:"noopener noreferrer"},P=n("h3",{id:"spritezero",tabindex:"-1"},[n("a",{class:"header-anchor",href:"#spritezero","aria-hidden":"true"},"#"),s(" spritezero")],-1),W={href:"https://github.com/mapbox/spritezero",target:"_blank",rel:"noopener noreferrer"},q=e(`<ol><li>安装</li></ol><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code><span class="token function">npm</span> <span class="token function">install</span> @mapbox/spritezero
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><blockquote><p>在 <code>Ubuntu</code> 安装成功，<code>Windows</code> 安装失败</p></blockquote><ol start="2"><li>使用</li></ol><div class="language-javascript line-numbers-mode" data-ext="js"><pre class="language-javascript"><code><span class="token keyword">var</span> spritezero <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;@mapbox/spritezero&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> fs <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;fs&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> glob <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;glob&#39;</span><span class="token punctuation">)</span>
<span class="token keyword">var</span> path <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">&#39;path&#39;</span><span class="token punctuation">)</span>

<span class="token punctuation">;</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">forEach</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">pxRatio</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> svgs <span class="token operator">=</span> glob<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;input/*.svg&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">f</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">{</span>
      <span class="token literal-property property">svg</span><span class="token operator">:</span> fs<span class="token punctuation">.</span><span class="token function">readFileSync</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">,</span>
      <span class="token literal-property property">id</span><span class="token operator">:</span> path<span class="token punctuation">.</span><span class="token function">basename</span><span class="token punctuation">(</span>f<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">&#39;.svg&#39;</span><span class="token punctuation">,</span> <span class="token string">&#39;&#39;</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> pngPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;output/sprite@&#39;</span> <span class="token operator">+</span> pxRatio <span class="token operator">+</span> <span class="token string">&#39;.png&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">var</span> jsonPath <span class="token operator">=</span> path<span class="token punctuation">.</span><span class="token function">resolve</span><span class="token punctuation">(</span>path<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span>__dirname<span class="token punctuation">,</span> <span class="token string">&#39;output/sprite@&#39;</span> <span class="token operator">+</span> pxRatio <span class="token operator">+</span> <span class="token string">&#39;.json&#39;</span><span class="token punctuation">)</span><span class="token punctuation">)</span>

  <span class="token comment">// Pass \`true\` in the layout parameter to generate a data layout</span>
  <span class="token comment">// suitable for exporting to a JSON sprite manifest file.</span>
  spritezero<span class="token punctuation">.</span><span class="token function">generateLayout</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">imgs</span><span class="token operator">:</span> svgs<span class="token punctuation">,</span> <span class="token literal-property property">pixelRatio</span><span class="token operator">:</span> pxRatio<span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token boolean">true</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> dataLayout</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span>
    fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>jsonPath<span class="token punctuation">,</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>dataLayout<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>

  <span class="token comment">// Pass \`false\` in the layout parameter to generate an image layout</span>
  <span class="token comment">// suitable for exporting to a PNG sprite image file.</span>
  spritezero<span class="token punctuation">.</span><span class="token function">generateLayout</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token literal-property property">imgs</span><span class="token operator">:</span> svgs<span class="token punctuation">,</span> <span class="token literal-property property">pixelRatio</span><span class="token operator">:</span> pxRatio<span class="token punctuation">,</span> <span class="token literal-property property">format</span><span class="token operator">:</span> <span class="token boolean">false</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> imageLayout</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    spritezero<span class="token punctuation">.</span><span class="token function">generateImage</span><span class="token punctuation">(</span>imageLayout<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span> image</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token keyword">return</span>
      fs<span class="token punctuation">.</span><span class="token function">writeFileSync</span><span class="token punctuation">(</span>pngPath<span class="token punctuation">,</span> image<span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),E={class:"custom-container tip"},M=n("p",{class:"custom-container-title"},"提示",-1),Q=n("li",null,[s("注意"),n("code",null,"node"),s("版本"),n("code",null,"v10"),s("及以上")],-1),R=n("code",null,"png",-1),X={href:"https://github.com/mapbox/spritezero/blob/main/lib/generate.js#L124",target:"_blank",rel:"noopener noreferrer"},Z=n("code",null,"mapnik.Image.fromSVGBytes",-1),B=n("code",null,"mapnik.Image.fromBytes",-1),V={href:"https://github.com/mapbox/spritezero-cli",target:"_blank",rel:"noopener noreferrer"},G={href:"https://docs.mapbox.com/help/troubleshooting/using-recolorable-images-in-mapbox-maps/",target:"_blank",rel:"noopener noreferrer"},H=n("li",null,[s("在 "),n("code",null,"generateLayout"),s(" 给 "),n("code",null,"dataLayout"),s(" 添加属性： "),n("code",null,"sdf: true")],-1),O={href:"https://github.com/mapbox/spritezero/pull/66",target:"_blank",rel:"noopener noreferrer"},C={href:"https://github.com/elastic/spritezero",target:"_blank",rel:"noopener noreferrer"},U={href:"http://www.npeihl.com/maki-sdf-sprites/",target:"_blank",rel:"noopener noreferrer"};function K(T,$){const a=o("ExternalLinkIcon");return c(),i("div",null,[r,n("blockquote",null,[n("p",null,[n("a",u,[s("sprite"),t(a)])])]),k,n("ul",null,[n("li",null,[n("a",d,[s("https://naivemap.com/mapbox/sprite.json"),t(a)]),s(" 和 "),n("a",m,[s("http://naivemap.com/mapbox/sprite.png"),t(a)]),s(" 或")]),n("li",null,[n("a",v,[s("https://naivemap.com/mapbox/sprite@2x.json"),t(a)]),s(" 和 "),n("a",g,[s("https://naivemap.com/mapbox/sprite@2x.png"),t(a)]),s("（高 DPI 设备）")])]),h,n("p",null,[s("通过 "),n("a",b,[s("map.addImage()"),t(a)]),s(" 方法向样式中添加图标。")]),_,n("p",null,[s("此外，当样式所需的图标丢失时将会触发 "),n("a",f,[s("styleimagemissing"),t(a)]),s(" 事件，通过该事件可添加指定 "),y,s(" 图标。")]),x,n("blockquote",null,[n("p",null,[s("示例："),n("a",j,[s("Generate and add a missing icon to the map"),t(a)])])]),w,n("p",null,[s("最直接的方法就是在 "),n("a",I,[s("Mapbox Studio"),t(a)]),s(" 中上传、管理图标。然后在样式预览中，将 "),S,s("、"),z,s("、"),N,s(" 和 "),L,s(" 文件下载下来使用。")]),n("div",A,[F,n("ol",null,[n("li",null,[s("只支持"),D,s("格式，可以在 "),n("a",Y,[s("iconfont"),t(a)]),s(" 下载图标上传")]),n("li",null,[s("官方推荐的地图图标集："),n("a",J,[s("MAKI ICONS"),t(a)])])])]),P,n("p",null,[s("也可以使用 "),n("a",W,[s("spritezero"),t(a)]),s(" 工具生成雪碧图文件。")]),q,n("div",E,[M,n("ol",null,[Q,n("li",null,[s("如果需要将"),R,s("转换为雪碧图，需要修改 "),n("a",X,[s("spritezero"),t(a)]),s(" 源码，将"),Z,s("修改为"),B,s("即可")]),n("li",null,[s("该库提供了命令行工具："),n("a",V,[s("spritezero-cli"),t(a)]),s("，可直接从文件夹生成雪碧图")]),n("li",null,[n("a",G,[s("SDF icons"),t(a)]),s("： "),n("ul",null,[H,n("li",null,[n("a",O,[s("Option to generate SDF sprites"),t(a)]),s("、"),n("a",C,[s("@elastic/spritezero"),t(a)])]),n("li",null,[n("a",U,[s("Demo of SDF sprites"),t(a)]),s(" :::")])])])])])])}const sn=p(l,[["render",K],["__file","sprite.html.vue"]]);export{sn as default};
